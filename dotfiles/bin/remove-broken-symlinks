#!/usr/bin/env python3

# Removes broken symlinks

import os
import sys


def list_files(path):
    for root, __, fs in os.walk(path):
        for f in fs:
            yield '%s/%s' % (root, f)


def predicate(path):
    return os.path.islink(path) and not os.path.exists(path)


if len(sys.argv) < 2:
    print("Usage: %s folder_name" % sys.argv[0])
    sys.exit(1)

fs = list_files(sys.argv[1])
bs = filter(predicate, fs)
for b in bs:
    print('Removing broken symlink: %s' % b)
    os.remove(b)
